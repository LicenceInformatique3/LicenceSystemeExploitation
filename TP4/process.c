#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include <time.h>
#include "process.h"

void process_init(){
	for(int i =0; i <= MAX_PROCESS;i++ ){
			processes[i].state = EMPTY;
	}
	current_process = 0;
}

void setProcessReady(int numProcess, PSW cpu){
	processes[numProcess].cpu = cpu;
	processes[numProcess].state = READY;
}

void nextProcess(){
	do{
		current_process = (current_process +1) % MAX_PROCESS;
		if(processes[current_process].state == SLEEP && processes[current_process].waketime <= time(NULL)){
            processes[current_process].state = READY; 
		}
	}while(processes[current_process].state != READY);
}
	

Process* process_alloc(){
    for(int i = 0; i < MAX_PROCESS; ++i){
        if(processes[i].state != EMPTY)
            continue;        
        return &processes[i];
    }   
    return NULL;
}
